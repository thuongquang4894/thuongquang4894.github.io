window.__require=function e(t,n,o){function r(s,a){if(!n[s]){if(!t[s]){var u=s.split("/");if(u=u[u.length-1],!t[u]){var c="function"==typeof __require&&__require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+s+"'")}s=u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){return r(t[s][1][e]||e)},l,l.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<o.length;s++)r(o[s]);return r}({GameManager:[function(e,t){"use strict";cc._RF.push(t,"505b8KJAbRF8aR9IraOTsda","GameManager");var n={Xoay:["Xoay1Day","Xoay2Day","Xoay3Day","Xoay4Day","Xoay5Day"],Quan:["Quan1Day","Quan2Day","Quan3Day","Quan4Day","Quan5Day"]},o=cc.Class({extends:cc.Component,properties:{txtNumberRope:cc.Label,txtNumberBet:cc.Label,txtUsername:cc.Label,txtBalance:cc.Label,txtJackpot:cc.Label,buttonStartGame:cc.Node,boxSetting:cc.Node,ropeSpine:sp.Skeleton,horsePrefab:cc.Prefab,horseRacingTrace:cc.Node,ropesPulling:[cc.Node]},statics:{Instance:null},onLoad:function(){this.loadUserInfo(UserModel),this.loadGameInfo(HorseGameModel)},start:function(){o.Instance=this,cc.director.getCollisionManager().enabled=!0,this.newGame()},resposeNewGame:function(e){this.isThrowing=!1,this.idHorseList=e,this.indexHorseCurrent=0;for(var t=0;t<this.idHorseList.length;t++)this.spawnHorseNext()},newGame:function(){this.horsesPulling=null,this.idHorseList=[],this.indexHorseCurrent=0,this.ropeSpine.node.active=!0,this.playAnimXoayDay();for(var e=0;e<this.ropesPulling.length;e++)this.ropesPulling[e].getComponent("Rope").hide();this.horseRacingTrace.removeAllChildren(),SimulateServerGameBull.requestNewGame(this.resposeNewGame.bind(this))},spawnHorseNext:function(){var e=HorseGameConfig.posHorseY[parseInt(Math.random()*HorseGameConfig.posHorseY.length)],t=this.getPosXNext(),n=cc.instantiate(this.horsePrefab);this.horseRacingTrace.addChild(n),n.setPosition(t,e);var o=n.getComponent("Horse");o.init(this.indexHorseCurrent,this.idHorseList[this.indexHorseCurrent]),this.indexHorseCurrent++,this.indexHorseCurrent>=this.idHorseList.length&&(this.indexHorseCurrent=0),o.startRun()},playAnimXoayDay:function(){this.ropeSpine.node.scale=1,this.ropeSpine.setAnimation(0,n.Xoay[HorseGameModel.numberRopeCurrent-1],!0)},playAnimQuanDay:function(){this.ropeSpine.node.scale=.7,this.ropeSpine.setAnimation(0,n.Quan[HorseGameModel.numberRopeCurrent-1],!1)},throwRopes:function(){var e=this;1!=this.isThrowing&&(this.isThrowing=!0,SimulateServerGameBull.requestResultGame(function(t){e.indexHorseWin=t,e.playAnimQuanDay(),e.stopHorses(),e.horsesPulling=e.findHorsesNearestCenter(HorseGameModel.numberRopeCurrent),e.scheduleOnce(e.handlePullingHorses.bind(e),1.1),e.scheduleOnce(e.handleWinloseHorses.bind(e),5),e.scheduleOnce(e.newGame.bind(e),14)}))},handleWinloseHorses:function(){for(var e=0;e<this.horsesPulling.length;e++){var t=this.horsesPulling[e].getComponent("Horse");this.indexHorseWin.includes(t.index)?t.win():(t.lose(),this.ropesPulling[e].getComponent("Rope").hide())}},handlePullingHorses:function(){this.ropeSpine.node.active=!1;for(var e=0;e<this.horsesPulling.length;e++){var t=this.horsesPulling[e].getComponent("Horse");t.pulling(),this.ropesPulling[e].getComponent("Rope").show(t.id,t.rope)}},findHorsesNearestCenter:function(e){return this.horseRacingTrace.children.sort(function(e,t){return Math.abs(e.x)-Math.abs(t.x)}).slice(0,Math.min(HorseGameConfig.numberRopeMax,e))},stopHorses:function(){for(var e=0;e<this.horseRacingTrace.children.length;e++)this.horseRacingTrace.children[e].getComponent("Horse").stopRun()},getPosXNext:function(){return 0==this.horseRacingTrace.children.length?-cc.view.getVisibleSize().width/2:this.horseRacingTrace.children[this.horseRacingTrace.children.length-1].position.x+HorseGameConfig.paddingHorse},spawnHorse:function(e){var t=cc.view.getVisibleSize().width/2,n=cc.instantiate(this.horsePrefab);this.horseRacingTrace.addChild(horse),n.setPosition(t+0,0);var o=n.getComponent("Horse");o.init(e,this.idHorseList[e]),o.startRun(),this.horseList.push(o)},loadUserInfo:function(){this.txtUsername.string=UserModel.nickname,this.txtBalance.string=Helper.numberFormat(UserModel.balance)},loadGameInfo:function(){HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeDefault,HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetDefault,this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent),this.txtJackpot.string=Helper.numberFormat(HorseGameModel.jackpot),this.playAnimXoayDay()},onClickDecreaseNumberRope:function(){1!=this.isThrowing&&(HorseGameModel.numberRopeCurrent--,HorseGameModel.numberRopeCurrent<HorseGameConfig.numberRopeMin&&(HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeMin),this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.playAnimXoayDay())},onClicIncreaseNumberRope:function(){1!=this.isThrowing&&(HorseGameModel.numberRopeCurrent++,HorseGameModel.numberRopeCurrent>HorseGameConfig.numberRopeMax&&(HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeMax),this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.playAnimXoayDay())},onClickDecreaseNumberBet:function(){1!=this.isThrowing&&(HorseGameModel.numberBetCurrent-=HorseGameConfig.numberBetStep,HorseGameModel.numberBetCurrent<HorseGameConfig.numberBetMin&&(HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetMin),this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent))},onClickIncreaseNumberBet:function(){1!=this.isThrowing&&(HorseGameModel.numberBetCurrent+=HorseGameConfig.numberBetStep,HorseGameModel.numberBetCurrent>HorseGameConfig.numberBetMax&&(HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetMax),this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent))},onClickStartThrowRope:function(){this.throwRopes()},onClickHome:function(){},onClickSetting:function(){this.boxSetting.active=!this.boxSetting.active},onClickSound:function(){},onClickTutorial:function(){},onClickHistory:function(){}});window.GameManager=o,cc._RF.pop()},{}],Helper:[function(e,t){"use strict";cc._RF.push(t,"30660xe7d1ApJV4P66V4Wlp","Helper"),window.Helper={numberFormat:function(e){return"number"!=typeof e?"":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}},cc._RF.pop()},{}],HorseGameConfig:[function(e,t){"use strict";cc._RF.push(t,"df005hE6WRPTaHe9LyXlPA6","HorseGameConfig");window.HorseGameConfig={speedHorse:500,numberRopeMin:1,numberRopeMax:5,numberRopeStep:1,numberRopeDefault:1,numberBetMin:1e3,numberBetMax:1e5,numberBetStep:1e3,numberBetDefault:1e3,numberHorse:9,ratiosHorseWin:[1,2,3,4,5,6,7,8,9],spaceHorses:[70,85,95,105,98,94,120,125,145],width:1560,height:720,posHorseY:[-20,0,20],timeScaleHorse:[.7,.8,.9,1],paddingHorse:200},cc._RF.pop()},{}],HorseGameModel:[function(e,t){"use strict";cc._RF.push(t,"6af10A41zVEnq4bkJBemgV4","HorseGameModel");window.HorseGameModel={jackpot:999999444,numberRopeCurrent:1,numberBetCurrent:1e3},cc._RF.pop()},{}],Horse:[function(e,t){"use strict";cc._RF.push(t,"0923aPTnjdDH583WLh2s4L9","Horse"),cc.Class({extends:cc.Component,properties:{type:"normal",spine:sp.Skeleton,rope:cc.Node,isRunning:!1,horseSkeletonData:[sp.SkeletonData],horseSkeletonDataIdle:[sp.SkeletonData]},onLoad:function(){this.initPosTargetX()},init:function(e,t){this.index=e,this.id=t,this.spine.skeletonData=this.horseSkeletonData[t-1],this.spine.timeScale=HorseGameConfig.timeScaleHorse[parseInt(Math.random()*HorseGameConfig.timeScaleHorse.length)],this.spine.setAnimation(0,"Chay",!0)},initPosTargetX:function(){this.posTargetX=0;var e=cc.view.getVisibleSize().width,t=this.getWidthHorse();this.posTargetX=-e/2-t},getWidthHorse:function(){return this.node.width},startRun:function(){this.isRunning=!0,this.spine&&(this.node.scale=1,this.spine.setAnimation(0,"Chay",!0))},stopRun:function(){this.isRunning=!1,this.spine&&(this.spine.skeletonData=this.horseSkeletonDataIdle[this.id-1],this.spine.setAnimation(0,"ThatBai",!0))},win:function(){cc.Tween.stopAllByTarget(this.spine.node),cc.Tween.stopAllByTarget(this.node),this.node.scale=.8,this.spine.skeletonData=this.horseSkeletonData[this.id-1],this.spine.setAnimation(0,"ThanhCong",!0)},lose:function(){var e=this;cc.Tween.stopAllByTarget(this.spine.node),cc.tween(this.spine.node).to(4,{position:new cc.Vec2(this.spine.node.position.x,0)}).start(),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(4,{scale:.8}).call(function(){e.node.scale=1,e.spine.skeletonData=e.horseSkeletonData[e.id-1],e.spine.setAnimation(0,"ThatBai",!0)}).start()},pulling:function(){this.spine.skeletonData=this.horseSkeletonData[this.id-1],this.spine.setAnimation(0,"BiKeo",!1),this.node.scale=.8,this.spine.skeletonData=this.horseSkeletonData[this.id-1],this.spine.addAnimation(1,"PhanKhang",!0),this.node.scale=.8,cc.Tween.stopAllByTarget(this.spine.node),cc.tween(this.spine.node).to(4,{position:new cc.Vec2(this.spine.node.position.x,this.spine.node.position.y-100)}).start(),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(4,{scale:.9}).start(),console.error("Checkinggame pulling")},setAnimation:function(){},update:function(e){this.isRunning&&(this.node.x-=HorseGameConfig.speedHorse*e,this.node.x<this.posTargetX&&(this.node.destroy(),GameManager.Instance.spawnHorseNext()))}}),cc._RF.pop()},{}],RopeManager:[function(e,t){"use strict";cc._RF.push(t,"a5a3fL5bwBMOIp5o92f567w","RopeManager"),cc.Class({extends:cc.Component,properties:{ropePrefab:cc.Prefab,ropeParent:cc.Node,ropeCount:5},throwRopes:function(){for(var e=80*-(this.ropeCount-1)/2,t=0;t<this.ropeCount;t++){var n=cc.instantiate(this.ropePrefab);n.x=e+80*t,n.y=-200,this.ropeParent.addChild(n),n.getComponent("Rope").throwToTop()}}}),cc._RF.pop()},{}],Rope:[function(e,t){"use strict";cc._RF.push(t,"758bcr6bs9AApF8V1U6RoQI","Rope"),cc.Class({extends:cc.Component,properties:{isFollowingHorse:!1},show:function(e,t){this.idHorse=e,this.targetNode=t,this.isFollowingHorse=!0,this.node.active=!0},hide:function(){this.targetNode=null,this.isFollowingHorse=!1,this.node.active=!1},updateRopeFollow:function(e,t){if(t){var n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),o=t.convertToWorldSpaceAR(cc.v2(0,0));o.y+=HorseGameConfig.spaceHorses[e-1];var r=o.sub(n),i=r.mag(),s=Math.atan2(r.x,r.y)*(180/Math.PI);this.node.height=i,this.node.angle=-s}},update:function(){this.isFollowingHorse&&this.updateRopeFollow(this.idHorse,this.targetNode)}}),cc._RF.pop()},{}],ServerConfigGameBull:[function(e,t){"use strict";cc._RF.push(t,"27bb1UQ6/hF95yv0gwc9yeV","ServerConfigGameBull"),window.ServerConfigGameBull={totalHorseRacing:20,totalHorseWin:10,idsHorse:[1,2,3,4,5,6,7,8,9],idsRatioHorse:[.1,.2,.35,.55,.6,.7,.8,.9,1]},cc._RF.pop()},{}],SimulateServerGameBull:[function(e,t){"use strict";cc._RF.push(t,"86020m9ehhAc7PQ4geSx7++","SimulateServerGameBull");var n={requestNewGame:function(e){e(this.generateRandomArray())},requestResultGame:function(e){for(var t=[],n=0;n<ServerConfigGameBull.totalHorseWin;n++){for(var o=this.randomIndexWin();t.includes(o);)o=this.randomIndexWin();t.push(o)}e(t)},generateRandomArray:function(){for(var e=ServerConfigGameBull.idsHorse,t=ServerConfigGameBull.totalHorseRacing,n=[],o=0;o<1;o++)n=n.concat(e);for(var r=Math.floor(t/n.length),i=t%n.length,s=[],a=0;a<r;a++)s=s.concat(this.shuffleArray([].concat(n)));if(i>0){var u=this.shuffleArray([].concat(n)).slice(0,i);s=s.concat(u)}return s},shuffleArray:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),o=[e[n],e[t]];e[t]=o[0],e[n]=o[1]}return e},randomIndexWin:function(){return parseInt(Math.random()*ServerConfigGameBull.totalHorseRacing+"")}};window.SimulateServerGameBull=n,cc._RF.pop()},{}],UIManager:[function(e,t){"use strict";cc._RF.push(t,"e7014zg+7pAUKQuUIsdsgzz","UIManager");var n=e("GameManager");cc.Class({extends:cc.Component,properties:{txtNumberRope:cc.Label,txtNumberBet:cc.Label,txtUsername:cc.Label,txtBalance:cc.Label,txtJackpot:cc.Label,buttonStartGame:cc.Node,boxSetting:cc.Node,ropeSprite:cc.Sprite,ropeSfsList:[cc.SpriteFrame],game:n},onLoad:function(){this.loadUserInfo(UserModel),this.loadGameInfo(HorseGameModel)},loadUserInfo:function(){this.txtUsername.string=UserModel.nickname,this.txtBalance.string=Helper.numberFormat(UserModel.balance)},loadGameInfo:function(){HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeDefault,HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetDefault,this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent),this.txtJackpot.string=Helper.numberFormat(HorseGameModel.jackpot),this.ropeSprite.node.active=!0,this.ropeSprite.spriteFrame=this.ropeSfsList[HorseGameModel.numberRopeCurrent-1]},onClickDecreaseNumberRope:function(){HorseGameModel.numberRopeCurrent--,HorseGameModel.numberRopeCurrent<HorseGameConfig.numberRopeMin&&(HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeMin),this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.ropeSprite.spriteFrame=this.ropeSfsList[HorseGameModel.numberRopeCurrent-1]},onClicIncreaseNumberRope:function(){HorseGameModel.numberRopeCurrent++,HorseGameModel.numberRopeCurrent>HorseGameConfig.numberRopeMax&&(HorseGameModel.numberRopeCurrent=HorseGameConfig.numberRopeMax),this.txtNumberRope.string=HorseGameModel.numberRopeCurrent,this.ropeSprite.spriteFrame=this.ropeSfsList[HorseGameModel.numberRopeCurrent-1]},onClickDecreaseNumberBet:function(){HorseGameModel.numberBetCurrent-=HorseGameConfig.numberBetStep,HorseGameModel.numberBetCurrent<HorseGameConfig.numberBetMin&&(HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetMin),this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent)},onClickIncreaseNumberBet:function(){HorseGameModel.numberBetCurrent+=HorseGameConfig.numberBetStep,HorseGameModel.numberBetCurrent>HorseGameConfig.numberBetMax&&(HorseGameModel.numberBetCurrent=HorseGameConfig.numberBetMax),this.txtNumberBet.string=Helper.numberFormat(HorseGameModel.numberBetCurrent)},onClickStartThrowRope:function(){n.Instance.throwRopes()},onClickHome:function(){},onClickSetting:function(){this.boxSetting.active=!this.boxSetting.active},onClickSound:function(){},onClickTutorial:function(){},onClickHistory:function(){}}),cc._RF.pop()},{GameManager:"GameManager"}],UserModel:[function(e,t){"use strict";cc._RF.push(t,"388b2quFOBPI4OSaAXMP52P","UserModel");window.UserModel={nickname:"bestdev",balance:1e7},cc._RF.pop()},{}]},{},["HorseGameConfig","HorseGameModel","UserModel","GameManager","Helper","Horse","Rope","RopeManager","ServerConfigGameBull","SimulateServerGameBull","UIManager"]);